<div class='mx-auto container'>
    <div class="container"><h3>Orders</h3></div>
    {{#each orders}}
    <div class='row my-3'>
        <div class='container-fluid border rounded p-4'>
            <div class="row">
                <div class="col-5">
                    <h5>ORDER#: {{this.order_no}}</h5>
                    <span class='font-weight-bold'>John Doe</span> - <span class='text-success'>{{this.status}}</span> <br>
                    <span>+63 917 123 4567 - {{this.buyer}}</span> <br>
                    <span>123 Main St., Manila City, Metro Manila</span>
                    <br><br>
                    <span class='font-weight-bold'>DATE ORDERED:</span> {{this.date_of_order}} <br>
                    <span class='font-weight-bold'>DATE ESTIMATED:</span> {{this.date_of_deliver}}

                    <div class="dropdown mt-3">
                        <button class="btn btn-secondary dropdown-toggle" type="button" id="statusMenu" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Change Order Status
                        </button>
                        <div class="dropdown-menu" aria-labelledby="statusMenu">
                            <a class="dropdown-item">Active</a>
                            <a class="dropdown-item">Hold</a>
                            <a class="dropdown-item">Cancelled</a>
                            <a class="dropdown-item">Delivered</a>
                        </div>
                    </div>
                </div>

                <div class='col-7'>
                    <table class="table">
                        <col width="180">
                        <col width="30">
                        <thead>
                            <tr>
                                <th>TOTAL</th>
                                <th id="totalprice">{{this.total_price}}</th>
                            </tr>
                        </thead>
                        <tbody>
                            {{#each orderitems}}
                            <tr>
                                <td>{{name}} (PHP <span class="price">{{price}}</span> X <span class="quantity">{{quantity}}</span>)</td>
                                <td><span class="total"></span></td>
                            </tr>
                            {{/each}}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    {{/each}}
</div>

<script>
    $(document).ready( function(){

        var total = $("#totalprice").text();
        total = total + ".00";
        $("#totalprice").text(total);

        var arr = $(".total");
        var p;
        var q;
        for(i=0; i<arr.length; i++)
        {
            p = $(arr[i]).parent().parent().children().children().filter(".price").text()
            q = $(arr[i]).parent().parent().children().children().filter(".quantity").text()
            console.log(p)
            $(arr[i]).text("" + p * q + ".00")
        }
    })
</script>
